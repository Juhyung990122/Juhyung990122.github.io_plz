{"componentChunkName":"component---src-templates-blog-post-js","path":"/Python/2020-08-05-TIL/","result":{"data":{"site":{"siteMetadata":{"title":"여름산책","author":"이주형","siteUrl":"https://juhyung990122.github.io","comment":{"disqusShortName":"Guinness990122","utterances":"Juhyung990122/Juhyung990122"},"sponsor":{"buyMeACoffeeId":""}}},"markdownRemark":{"id":"c3ebc6bb-044b-5bca-915a-85e34e877b59","excerpt":"🌟크롤링 🎯웹크롤러란? 자동으로 웹페이지를 돌아다니며 웹페이지에 포함된 각종 정보들 중 원하는 정보를 수집해오는 프로그램입니다.\n크롤러를 사용하면 사람이 손으로 일일히 데이터를 가져오지 않아도 \n자동적으로 데이터를 수집할 수 있다는 장점이 있습니다. \n하지만 한편으로는 개인정보를 긁어가는 등 악용의 여지가 있으니 사용에 주의를 기울여야합니다. 🎯크롤러 만들때 알아두면 좋은 Headless selenium…","html":"<h2 id=\"크롤링\" style=\"position:relative;\"><a href=\"#%ED%81%AC%EB%A1%A4%EB%A7%81\" aria-label=\"크롤링 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>🌟크롤링</h2>\n<h3 id=\"웹크롤러란\" style=\"position:relative;\"><a href=\"#%EC%9B%B9%ED%81%AC%EB%A1%A4%EB%9F%AC%EB%9E%80\" aria-label=\"웹크롤러란 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>🎯웹크롤러란?</h3>\n<p>자동으로 웹페이지를 돌아다니며 웹페이지에 포함된 각종 정보들 중 원하는 정보를 수집해오는 프로그램입니다.\n크롤러를 사용하면 사람이 손으로 일일히 데이터를 가져오지 않아도\n자동적으로 데이터를 수집할 수 있다는 장점이 있습니다.\n하지만 한편으로는 개인정보를 긁어가는 등 악용의 여지가 있으니 사용에 주의를 기울여야합니다.</p>\n<h3 id=\"크롤러-만들때-알아두면-좋은-headless\" style=\"position:relative;\"><a href=\"#%ED%81%AC%EB%A1%A4%EB%9F%AC-%EB%A7%8C%EB%93%A4%EB%95%8C-%EC%95%8C%EC%95%84%EB%91%90%EB%A9%B4-%EC%A2%8B%EC%9D%80-headless\" aria-label=\"크롤러 만들때 알아두면 좋은 headless permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>🎯크롤러 만들때 알아두면 좋은 Headless</h3>\n<p>selenium라는 브라우저 자동화툴을 이용하여 크롤링을 진행하는데 데이터만 필요하고\n창을 직접적으로 볼 필요가 없을땐 어떻게 해야할까요?\n이때 사용할 수 있는게 <strong>headless</strong> 옵션입니다.\nheadless옵션을 사용하게 된다면 사용자에게는 창이 보이지않지만 브라우저를 조종하여\n화면에 나타나는 데이터를 가져올 수 있습니다.\n근데 사실 이렇게 데이터를 가져오는건 웹사이트 입장에서는 트래픽이 늘어나는거라서 달갑지 않을 수 있습니다.\n그래서 일부 웹사이트는 headless 접근을 막아놓기도 하는데요.\n이를 우회하기 위해선 다음의 사항들을 보완해주어야 합니다.</p>\n<h3 id=\"headless로-만들때-건드려야하는-것들\" style=\"position:relative;\"><a href=\"#headless%EB%A1%9C-%EB%A7%8C%EB%93%A4%EB%95%8C-%EA%B1%B4%EB%93%9C%EB%A0%A4%EC%95%BC%ED%95%98%EB%8A%94-%EA%B2%83%EB%93%A4\" aria-label=\"headless로 만들때 건드려야하는 것들 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>🎯Headless로 만들때 건드려야하는 것들</h3>\n<h4 id=\"1-user-agent\" style=\"position:relative;\"><a href=\"#1-user-agent\" aria-label=\"1 user agent permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. User-agent</h4>\n<p>브라우저는 지금 접근한 유저가 headless인지 아닌지를 user-agent를 통해 식별합니다.\n(user agent 값 안에 chrome이 아닌 headlesschrome으로 뜹니다.)\n이는 user-agent 값을 바꾸어 줌으로써 해결할 수 있습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">ptions<span class=\"token punctuation\">.</span>add_argument<span class=\"token punctuation\">(</span><span class=\"token string\">\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.105 Safari/537.36\"</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>위의 코드를 통해 driver의 option으로 user-agent값을 headless가 아닌\n일반 크롬 user agent값으로 바꾸어서 driver에 값으로 넘겨주어 식별을 피합니다.</p>\n<h4 id=\"2-plugins-개수\" style=\"position:relative;\"><a href=\"#2-plugins-%EA%B0%9C%EC%88%98\" aria-label=\"2 plugins 개수 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. Plugins 개수</h4>\n<p>브라우저 중 크롬은 브라우저 실행시 자동적으로 설치되는 플러그인이 있는데\nheadless는 이 플러그인란이 비어있습니다. 따라서 headless를 식별할 때 플러그인 설치여부를 확인하기도합니다.\n이는 javascript로 플러그인을 가짜로 넣어주는걸로 해결할 수 있습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">driver<span class=\"token punctuation\">.</span>execute_script<span class=\"token punctuation\">(</span><span class=\"token string\">\"Object.defineProperty(navigator, 'plugins', {get: function() {return[1, 2, 3];},});\"</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>위의 코드를 이용하여 navigator 의 plugins 속성을 자바스크립트로 오버라이딩한 뒤\n리스트를 리턴함으로서 플러그인 갯수를 가짜로 넘겨주면 plugin 개수로 headless를 판별할 수 없게됩니다.</p>\n<h4 id=\"3-선호-언어\" style=\"position:relative;\"><a href=\"#3-%EC%84%A0%ED%98%B8-%EC%96%B8%EC%96%B4\" aria-label=\"3 선호 언어 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3. 선호 언어</h4>\n<p>브라우저는 사용자가 자주 쓰는 언어를 선호언어로 등록해둡니다.\n하지만 headless는 선호언어가 비어있어 식별기준이 될 수 있습니다.\n이는 옵션으로 선호언어를 설정해줌으로서 해결할 수 있습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">options<span class=\"token punctuation\">.</span>add_argument<span class=\"token punctuation\">(</span><span class=\"token string\">\"lang=ko_KR\"</span><span class=\"token punctuation\">)</span> </code></pre></div>\n<p>참고 : <a href=\"https://beomi.github.io/2017/09/28/HowToMakeWebCrawler-Headless-Chrome/\">https://beomi.github.io/2017/09/28/HowToMakeWebCrawler-Headless-Chrome/</a></p>","frontmatter":{"title":"[Crawler] 파이썬으로 크롤러 만들때 알야아할 것","date":"August 07, 2020"}}},"pageContext":{"slug":"/Python/2020-08-05-TIL/","previous":{"fields":{"slug":"/DRF/2020-07-30-TIL/"},"frontmatter":{"title":"[DRF] ViewSet이란?","category":"DRF","draft":false}},"next":{"fields":{"slug":"/Django/2020-08-11-TIL/"},"frontmatter":{"title":"[Django] 소셜로그인(Social login) 구현하기","category":"Django","draft":false}}}},"staticQueryHashes":["3128451518","521680639"]}